#tag WindowBegin Window RegCodeWindow   BackColor       =   &cFFFFFF00   Backdrop        =   0   CloseButton     =   True   Compatibility   =   ""   Composite       =   False   Frame           =   0   FullScreen      =   False   FullScreenButton=   False   HasBackColor    =   False   Height          =   317   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   -1158003109   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Generate Registration Code"   Visible         =   True   Width           =   613   Begin GroupBox GroupBox2      AutoDeactivate  =   True      Bold            =   False      Caption         =   "Registraton Code Details"      Enabled         =   True      Height          =   145      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   15      Transparent     =   True      Underline       =   False      Visible         =   True      Width           =   573      Begin Label StaticText1         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   False         Left            =   40         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Identifier:"         TextAlign       =   0         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   50         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   100      End      Begin Label StaticText2         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   False         Left            =   40         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Version:"         TextAlign       =   0         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   85         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   100      End      Begin Label StaticText3         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   False         Left            =   40         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Multiline       =   False         Scope           =   0         Selectable      =   False         TabIndex        =   2         TabPanelIndex   =   0         TabStop         =   True         Text            =   "Name:"         TextAlign       =   0         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   118         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   100      End      Begin TextField IdentifierField         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &cFFFFFF00         Bold            =   False         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   "The Identifier is used in the calculation of the registration code in order to make it possible to have different registration codes for different products registered in the same name."         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   False         Left            =   164         LimitText       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Mask            =   ""         Password        =   False         ReadOnly        =   False         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   49         Transparent     =   True         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   409      End      Begin TextField VersionField         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &cFFFFFF00         Bold            =   False         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   "Use if you want keys to expire when a new version is released."         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   False         Left            =   164         LimitText       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Mask            =   ""         Password        =   False         ReadOnly        =   False         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   84         Transparent     =   True         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   409      End      Begin TextField NameField         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   False         BackColor       =   &cFFFFFF00         Bold            =   False         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   "The Name is the name of the person or company that is registering the software."         Index           =   -2147483648         InitialParent   =   "GroupBox2"         Italic          =   False         Left            =   164         LimitText       =   0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   False         LockRight       =   False         LockTop         =   False         Mask            =   ""         Password        =   False         ReadOnly        =   False         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   0         TabStop         =   True         Text            =   ""         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   117         Transparent     =   True         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   409      End   End   Begin Label StaticText4      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   40      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   False      Scope           =   0      Selectable      =   False      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Generated Code:"      TextAlign       =   0      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   183      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   111   End   Begin MainToolbar Toolbar11      Enabled         =   True      Index           =   -2147483648      InitialParent   =   ""      LockedInPosition=   False      Scope           =   0      TabPanelIndex   =   0      Visible         =   True   End   Begin Separator Separator1      AutoDeactivate  =   True      Enabled         =   True      Height          =   4      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Top             =   256      Transparent     =   True      Visible         =   True      Width           =   573   End   Begin Label RegCodeLabel      AutoDeactivate  =   True      Bold            =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   20      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Multiline       =   True      Scope           =   0      Selectable      =   False      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Text            =   "RegCode %1"      TextAlign       =   1      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   272      Transparent     =   False      Underline       =   False      Visible         =   True      Width           =   573   End   Begin TextArea GeneratedCodeField      AcceptTabs      =   False      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   True      BackColor       =   &cFFFFFF00      Bold            =   False      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   61      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      Italic          =   False      Left            =   163      LimitText       =   0      LineHeight      =   0.0      LineSpacing     =   1.0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   False      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &c00000000      TextFont        =   "System"      TextSize        =   0.0      TextUnit        =   0      Top             =   183      Transparent     =   False      Underline       =   False      UseFocusRing    =   True      Visible         =   True      Width           =   430   EndEnd#tag EndWindow#tag WindowCode	#tag MenuHandler		Function CodeGenerate() As Boolean Handles CodeGenerate.Action			Generate		End Function	#tag EndMenuHandler	#tag MenuHandler		Function CodeValidate() As Boolean Handles CodeValidate.Action			Validate		End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub Generate()		  Dim regCode As New RegCode		  		  GeneratedCodeField.Text = regCode.Generate(IdentifierField.Text, VersionField.Text, NameField.Text)		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub Validate()		  Dim validate As New ValidateWindow		  		  validate.ShowModalWithin(Self)		  		  Dim code As String = validate.RegCodeField.Text		  		  validate.Close		  		  If code <> "" Then		    		    Dim regCode As New RegCode		    Dim resultText As String		    Dim result As New MessageDialog		    		    If regCode.Validate(code, IdentifierField.Text, VersionField.Text, NameField.Text) Then		      // Code is good		      resultText = "good"		      result.Icon = MessageDialog.GraphicNote		    Else		      // Code is bad		      resultText = "bad"		      result.Icon = MessageDialog.GraphicStop		    End If		    		    result.Message = "The code (" + code + ") is " + resultText + "."		    		    Call result.ShowModalWithin(Self)		    		  End If		End Sub	#tag EndMethod#tag EndWindowCode#tag Events Toolbar11	#tag Event		Sub Action(item As ToolItem)		  Select Case ToolButton(item).Caption		  Case"Generate"		    Generate		  Case "Validate"		    Validate		  End Select		  		End Sub	#tag EndEvent#tag EndEvents#tag Events RegCodeLabel	#tag Event		Sub Open()		  Me.Text = Me.Text.ReplaceAll("%1", RegCode.Version)		End Sub	#tag EndEvent#tag EndEvents#tag ViewBehavior	#tag ViewProperty		Name="Name"		Visible=true		Group="ID"		Type="String"		EditorType="String"	#tag EndViewProperty	#tag ViewProperty		Name="Interfaces"		Visible=true		Group="ID"		Type="String"		EditorType="String"	#tag EndViewProperty	#tag ViewProperty		Name="Super"		Visible=true		Group="ID"		Type="String"		EditorType="String"	#tag EndViewProperty	#tag ViewProperty		Name="Width"		Visible=true		Group="Size"		InitialValue="600"		Type="Integer"	#tag EndViewProperty	#tag ViewProperty		Name="Height"		Visible=true		Group="Size"		InitialValue="400"		Type="Integer"	#tag EndViewProperty	#tag ViewProperty		Name="MinWidth"		Visible=true		Group="Size"		InitialValue="64"		Type="Integer"	#tag EndViewProperty	#tag ViewProperty		Name="MinHeight"		Visible=true		Group="Size"		InitialValue="64"		Type="Integer"	#tag EndViewProperty	#tag ViewProperty		Name="MaxWidth"		Visible=true		Group="Size"		InitialValue="32000"		Type="Integer"	#tag EndViewProperty	#tag ViewProperty		Name="MaxHeight"		Visible=true		Group="Size"		InitialValue="32000"		Type="Integer"	#tag EndViewProperty	#tag ViewProperty		Name="Frame"		Visible=true		Group="Frame"		InitialValue="0"		Type="Integer"		EditorType="Enum"		#tag EnumValues			"0 - Document"			"1 - Movable Modal"			"2 - Modal Dialog"			"3 - Floating Window"			"4 - Plain Box"			"5 - Shadowed Box"			"6 - Rounded Window"			"7 - Global Floating Window"			"8 - Sheet Window"			"9 - Metal Window"			"11 - Modeless Dialog"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="Title"		Visible=true		Group="Frame"		InitialValue="Untitled"		Type="String"	#tag EndViewProperty	#tag ViewProperty		Name="CloseButton"		Visible=true		Group="Frame"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="Resizeable"		Visible=true		Group="Frame"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="MaximizeButton"		Visible=true		Group="Frame"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="MinimizeButton"		Visible=true		Group="Frame"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="FullScreenButton"		Visible=true		Group="Frame"		InitialValue="False"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="Composite"		Group="OS X (Carbon)"		InitialValue="False"		Type="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="MacProcID"		Group="OS X (Carbon)"		InitialValue="0"		Type="Integer"	#tag EndViewProperty	#tag ViewProperty		Name="ImplicitInstance"		Visible=true		Group="Behavior"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="Placement"		Visible=true		Group="Behavior"		InitialValue="0"		Type="Integer"		EditorType="Enum"		#tag EnumValues			"0 - Default"			"1 - Parent Window"			"2 - Main Screen"			"3 - Parent Window Screen"			"4 - Stagger"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="Visible"		Visible=true		Group="Behavior"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="LiveResize"		Group="Behavior"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="FullScreen"		Group="Behavior"		InitialValue="False"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="HasBackColor"		Visible=true		Group="Background"		InitialValue="False"		Type="Boolean"	#tag EndViewProperty	#tag ViewProperty		Name="BackColor"		Visible=true		Group="Background"		InitialValue="&hFFFFFF"		Type="Color"	#tag EndViewProperty	#tag ViewProperty		Name="Backdrop"		Visible=true		Group="Background"		Type="Picture"		EditorType="Picture"	#tag EndViewProperty	#tag ViewProperty		Name="MenuBar"		Visible=true		Group="Menus"		Type="MenuBar"		EditorType="MenuBar"	#tag EndViewProperty	#tag ViewProperty		Name="MenuBarVisible"		Visible=true		Group="Deprecated"		InitialValue="True"		Type="Boolean"		EditorType="Boolean"	#tag EndViewProperty#tag EndViewBehavior